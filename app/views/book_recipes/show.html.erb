<%= render partial: "recipes/tabs" %>

<%= content_for :title, @recipe.fullname + " - HedaCuisine" %>
<% description = description_recipe_ingredients(@recipe) %>
<%= content_for :description, description_recipe_ingredients(@recipe) %>
<%= content_for :og_tags do %>
  <meta property="og:title" content="<%= @recipe.fullname %>">
  <meta property="og:image" content="<%= prod_url(medium_image_path(@recipe.image)) %>" >
  <meta property="og:type" content="website">
  <meta property="og:url" content="<%= prod_url(request.original_fullpath) %>">
  <meta property="og:description" content="<%= description %>">
<% end %>

<div style="display: flex; gap: 10px;">
  <div>
    <%= render partial: "books/sidebar", locals: {book: @book} %>
  </div>
  <div>
    <% if @recipe.recipe_kind %>
      <%= render partial: "kinds/breadcrumbs", locals: {leaf: @recipe.recipe_kind} %>
    <% end %>
    
    <% if user_signed_in? %>
      <% machine = current_user.machines.first_or_create %>
      <div class="collapse" id="calendar">
        <%= render partial: "meals/calendar", locals: {recipe: @recipe, machine: machine, meals: machine.meals.includes(:recipe) } %>
        <div style="height: 10px;"></div>
      </div>
    <% end %>
    
    <%= render partial: "recipes/recipe_description_with_image", locals: {recipe: @recipe} %>
    
    <div style="display: flex; gap: 30px;">
      <div>
        <%= render partial: "recipes/recipe_body", locals: {recipe: @recipe, hide_header: true} %>
      </div>
      <% if @recipe.recipe_kind %>
        <div>
          <div style="width: 280px; font-size: 1.2em; border: 2px solid black; border-radius: 20px; padding: 1em;">
            <%= link_to @recipe.recipe_kind, style: "color: black;" do %>
              <div style="font-size: 1.2em;"><b><%= translated(@recipe.recipe_kind.name) %></b></div>
              <p><i><%= my_sanitize(@recipe.recipe_kind.description_html) %></i></p>
              <% nb = @recipe.recipe_kind.recipes.all_public.count %>
              <p style="font-size: 0.9em;">Sur ce site, il y a <%= nb %> recettes disponibles dans cette cat√©gorie.</p>
              <%= link_to "Voir les recettes similaires", @recipe.recipe_kind, class: "btn btn-outline-primary" %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
    
    <div style="height: 1rem;"></div>
    
  </div>
</div>

<%# javascript_pack_tag "recipe" %>
<%= javascript_pack_tag "toggle_link" %>
<%= javascript_pack_tag "dropdown_submenu" %>
<%= javascript_pack_tag current_user ? "recipe_rating" : "recipe_rating_read_only" %>
<%= javascript_pack_tag "recipes_show" %>
